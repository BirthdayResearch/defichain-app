on:
  release:
    types: [created]

jobs:
  publish_linux_version:
    runs-on: ubuntu-latest
    env:
      GH_TOKEN: ${{ secrets.GH_TOKEN}}

    steps:
      - uses: actions/checkout@v2

      - name: install dependencies
        run: npm cache clean --force && npm run init

      - name: Build app
        run: npm run pre:build:linux

      - name: Publish app
        run: npm run publish:linux

  publish_mac_version:
    runs-on: macos-latest
    env:
      GH_TOKEN: ${{ secrets.GH_TOKEN}}
      CSC_LINK: ${{ secrets.CSC_LINK}}
      CSC_KEY_PASSWORD: ${{ secrets.CSC_KEY_PASSWORD}}

    steps:
      - uses: actions/checkout@v2

      - name: install dependencies
        run: npm cache clean --force && npm run init

      - name: Build app
        run: npm run pre:build:mac

      - name: Publish app
        run: npm run publish:mac

  publish_windows_version:
    runs-on: windows-latest
    env:
      GH_TOKEN: ${{ secrets.GH_TOKEN}}

    steps:
      - uses: actions/checkout@v2

      - name: install dependencies
        run: npm cache clean --force && npm run init

      - name: Build app
        run: npm run pre:build:win

      - name: Publish app
        run: npm run publish:win
